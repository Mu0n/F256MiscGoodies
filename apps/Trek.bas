10    rem "SUPER STARTREK - MAY 16,1978 - REQUIRES 24K MEMORY"30    rem 40    rem "****        **** STAR TREK ****        ****"50    rem "**** SIMULATION OF A MISSION OF THE STARSHIP ENTERPRISE,"60    rem "**** AS SEEN ON THE STAR TREK TV SHOW."70    rem "**** ORIGINAL PROGRAM BY MIKE MAYFIELD, MODIFIED VERSION"80    rem "**** PUBLISHED IN DEC'S -101 BASIC GAMES-, BY DAVE AHL."90    rem "**** MODIFICATIONS TO THE LATTER (PLUS DEBUGGING) BY BOB"100   rem "*** LEEDOM - APRIL & DECEMBER 1974,"110   rem "*** WITH A LITTLE HELP FROM HIS FRIENDS . . ."120   rem "*** COMMENTS, EPITHETS, AND SUGGESTIONS SOLICITED --"130   rem "*** SEND TO:  R. C. LEEDOM"140   rem "***           WESTINGHOUSE DEFENSE & ELECTRONICS SYSTEMS CNTR."150   rem "***           BOX 746, M.S. 338"160   rem "***           BALTIMORE, MD  21203"170   rem "***"180   rem "*** CONVERTED TO MICROSOFT 8 K BASIC 3/16/78 BY JOHN GORDERS"190   rem "*** LINE NUMBERS FROM VERSION STREK7 OF 1/12/75 PRESERVED AS"200   rem "*** MUCH AS POSSIBLE WHILE USING MULTIPLE STATEMENTS PER LINE"205   rem "*** SOME LINES ARE LONGER THAN 72 CHARACTERS; THIS WAS DONE"210   rem "*** BY USING ? INSTEAD OF PRINT WHEN ENTERING LINES"215   rem "***"217   dim g(8,8),c(9,2),k(3,3),n(3),z(8,8),d#(8)218   cls 220   print :print :print :print :print :print :print :print :print :print :print 221   print "                                    ,------*------,"222   print "                    ,-------------   '---  ------'"223   print "                     '-------- --'      / /"224   print "                         ,---' '-------/ /--,"225   print "                          '----------------'":print 226   print "                    THE USS ENTERPRISE --- NCC-1701"227   print :print :print :print :print 260   rem "clear 600"270   z$="                         "370   t#=(random(20)+20)*100:t0#=t#:t9=25+random(10):d0=0:e=3000:e0=e440   p=10:p0=p:s9=200:s=0:b9=2:k9=0:x$="":x0$=" IS "470   rem "DEF FND(D)=SQR((K(I,1)-S1)^2+(K(I,2)-S2)^2)"475   rem "DEF FNR(R)=INT(RND(R)*7.98+1.01)"480   rem "INITIALIZE ENTERPRISE'S POSITION"490   q1=random(8)+1:q2=random(8)+1:s1=random(8)+1:s2=random(8)+1530   for i=1 to 9:c(i,1)=0:c(i,2)=0:next 540   c(3,1)=-1:c(2,1)=-1:c(4,1)=-1:c(4,2)=-1:c(5,2)=-1:c(6,2)=-1600   c(1,2)=1:c(2,2)=1:c(6,1)=1:c(7,1)=1:c(8,1)=1:c(8,2)=1:c(9,2)=1670   for i=1 to 8:d#(i)=0:next 710   rem "A1$=NAVSRSLRSPHATORSHEDAMCOMXXX"810   rem "SETUP WHAT EXISTS IN GALAXY . . ."815   rem "K3= # KLINGONS  B3= # STARBASES  S3 = # STARS"820   for i=1 to 8:for j=1 to 8:k3=0:z(i,j)=0:r1#=rnd(1)850   if r1#>0.98 then k3=3:k9=k9+3:goto 980860   if r1#>0.95 then k3=2:k9=k9+2:goto 980870   if r1#>0.80 then k3=1:k9=k9+1980   b3=0:if random(100)>96 then b3=1:b9=b9+11040  g(i,j)=k3*100+b3*10+random(8)+1:next :next :if k9>t9# then t9#=k9+11100  if b9<>0 then goto 12001150  if g(q1,q2)<200 then g(q1,q2)=g(q1,q2)+120:k9=k9+11160  b9=1:g(q1,q2)=g(q1,q2)+10:q1=random(8)+1:q2=random(8)+11200  k7=k9:if b9<>1 then x$="S":x0$=" ARE "1230  print "YOUR ORDERS ARE AS FOLLOWS:"1240  print "   DESTROY THE ";k9;" KLINGON WARSHIPS WHICH HAVE INVADED"1252  print "   THE GALAXY BEFORE THEY CAN ATTACK FEDERATION HEADQUARTERS"1260  print "   ON STARDATE ";t0#+t9#;"  THIS GIVES YOU ";t9;" DAYS.  THERE";x0$1272  print "   ";b9;" STARBASE";x$;" IN THE GALAXY FOR RESUPPLYING YOUR SHIP"1280  print :rem "print`y|z}|}z~`}~z}y|y|y{{}`|{}}y~|"1300  print :print "Press any key to begin!"1305  key=0:while key=0:key=inkey():wend 1310  rem "HERE ANY TIME NEW QUADRANT ENTERED"1320  z4=q1:z5=q2:k3=0:b3=0:s3=0:g5=0:d4#=0.5*rnd(1):z(q1,q2)=g(q1,q2)1390  if ((q1<1^q1>8)^(q2<1^q2))>8 then goto 16001430  gosub 9030:print :if t0#<>t# then goto 14901460  print "YOUR MISSION BEGINS WITH YOUR STARSHIP LOCATED"1470  print "IN THE GALACTIC QUADRANT, '";g2$;"'.":goto 15001490  print "NOW ENTERING ";g2$;" QUADRANT . . ."1500  print :k3=int(g(q1,q2)*0.01):b3=int(g(q1,q2)*0.1)-10*k31540  s3=g(q1,q2)-100*k3-10*b3:if k3=0 then goto 15901560  print "COMBAT AREA      CONDITION RED":if s>200 then goto 15901580  print "   SHIELDS DANGEROUSLY LOW"1590  for i=1 to 3:k(i,1)=0:k(i,2)=0:next 1600  for i=1 to 3:k(i,3)=0:next :q$=z$+z$+z$+z$+z$+z$+z$+left$(z$,17)1660  rem "POSITION ENTERPRISE IN QUADRANT, THEN PLACE K3 KLINGONS, &"1670  rem "B3 STARBASES, & S3 STARS ELSEWHERE."1680  a$="<*>":z1=s1:z2=s2:gosub 8670:if k3<1 then goto 18201720  for i=1 to k3:gosub 8590:a$="+K+":z1=r1:z2=r21780  gosub 8670:k(i,1)=r1:k(i,2)=r2:k(i,3)=int(s9*(0.5+rnd(1))):next 1820  if b3<1 then goto 19101880  gosub 8590:a$=">!<":z1=r1:b4=r1:z2=r2:b5=r2:gosub 86701910  for i=1 to s3:gosub 8590:a$=" * ":z1=r1:z2=r2:gosub 8670:next 1980  gosub 64301990  if (s+e)>101995  if e>10 then goto 20602000  if d(7)=0 then goto 20602010  endif 2020  print :print "** FATAL ERROR **   YOU'VE JUST STRANDED YOUR SHIP IN "2030  print "SPACE":print "YOU HAVE INSUFFICIENT MANEUVERING ENERGY,";2040  print " AND SHIELD CONTROL":print "IS PRESENTLY INCAPABLE OF CROSS";2050  print "-CIRCUITING TO ENGINE ROOM!!":goto 62202060  print "PRESS COMMAND NUMBER TO EXECUTE:"2070  print 2080  print "1. SET COURSE"2090  print "2. SHORT RANGE SENSOR SCAN"2100  print "3. LONG RANGE SENSOR SCAN"2110  print "4. FIRE PHASERS"2120  print "5. FIRE PHOTON TORPEDOES"2130  print "6. RAISE OR LOWER SHIELDS"2140  print "7. DAMAGE CONTROL REPORTS"2150  print "8. CALL ON LIBRARY-COMPUTER"2160  print "9. RESIGN YOUR COMMAND":print 2170  key=0:while (key<49)^(key>57):key=inkey():wend 2175  if key=48+1 then goto 23002180  if key=48+2 then goto 19802185  if key=48+3 then goto 40002190  if key=48+4 then goto 42602195  if key=48+5 then goto 47002200  if key=48+6 then goto 55302205  if key=48+7 then goto 56902210  if key=48+8 then goto 72902215  if key=48+9 then goto 62702220  goto 2060:rem "FLOW SHOULD NEVER REACH HERE!, BUT JIC"2290  rem "COURSE CONTROL BEGINS HERE"2300  input "COURSE (0-9)";c1:if c1=9 then c1=12310  if (c1>=1)&(c1<9) then goto 23502330  print "   LT. SULU REPORTS, 'INCORRECT COURSE DATA, SIR!'":goto 19902350  x$="8":if d#(1)<0 then x$="0.2"2360  print "WARP FACTOR (0-";x$;")";2370  input w1#:if (d#(1)<0)&(w1#>0.2) then goto 24702380  if (w1#>0)&(w1#<=8) then goto 24902390  if (w1#=0) then goto 19902420  print "   CHIEF ENGINEER SCOTT REPORTS 'THE ENGINES WON'T TAKE";2430  print " WARP ";w1#;"!'":goto 19902470  print "WARP ENGINES ARE DAMAGED.  MAXIMUM SPEED = WARP 0.2":goto 19902490  n=int(w1#*8+0.5):if e-n>=0 then goto 25902500  print "ENGINEERING REPORTS   'INSUFFICIENT ENERGY AVAILABLE"2510  print "                       FOR MANEUVERING AT WARP";w1#;"!'"2530  if (s<n-e)^(d(7)<0) then goto 19902550  print "DEFLECTOR CONTROL ROOM ACKNOWLEDGES ";s;" UNITS OF ENERGY"2560  print "                         PRESENTLY DEPLOYED TO SHIELDS."2570  goto 19902580  rem "KLINGONS MOVE/FIRE ON MOVING STARSHIP . . ."2590  for i=1 to k3:if k(i,3)=0 then goto 27002610  a$="   ":z1=k(i,1):z2=k(i,2):gosub 8670:gosub 85902660  k(i,1)=z1:k(i,2)=z2:a$="+K+":gosub 86702700  next :gosub 6000:d1#=0:d6#=w1#:if w1#>=1 then d6#=12770  for i=1 to 8:if d#(i)>=0 then goto 28802790  d#(i)=d#(i)+d6#:if (d#(i)>-0.1)&(d#(i)<0) then d#(i)=-0.1:goto 28802800  if d#(i)<0 then goto 28802810  if d1#<>1 then d1#=1:print "DAMAGE CONTROL REPORT:  ";2840  print spc(8);:r1=i:gosub 8790:print g2$;" REPAIR COMPLETED."2880  next :if rnd(1)>0.2 then goto 30702910  r1=random(8)+1:if rnd(1)>=0.6 then goto 30002930  d#(r1)=d#(r1)-(random(5)+1):print "DAMAGE CONTROL REPORT:  ";2960  gosub 8790:print g2$;" DAMAGED":print :goto 30703000  d#(r1)=d#(r1)+random(3)+1:print "DAMAGE CONTROL REPORT:  ";3030  gosub 8790:print g2$;" STATE OF REPAIR IMPROVED":print 3060  rem "BEGIN MOVING STARSHIP"3070  a$="   ":z1=int(s1):z2=int(s2):gosub 86703110  x1=c(c1,1)+(c(c1+1,1)-c(c1,1))*(c1-int(c1)):x=s1:y=s23140  x2=c(c1,2)+(c(c1+1,2)-c(c1,2))*(c1-int(c1)):q4=q1:q5=q23170  for i=1 to n:s1=s1+x1:s2=s2+x23180  if (s1<1)^(s1>=9)^(s2<1)^(s2>=9) then goto 35003240  s8=int(s1)*24+int(s2)*3-26:if mid$(q$,s8,2)="  "then goto 33603320  s1=int(s1-x1):s2=int(s2-x2):print "WARP ENGINES SHUT DOWN AT ";3350  print "SECTOR ";s1;",";s2;" DUE TO BAD NAVIGATION":goto 33703360  next :s1=int(s1):s2=int(s2)3370  a$="<*>":z1=int(s1):z2=int(s2):gosub 8670:gosub 3910:t8#=13430  if w1#<1 then t8#=0.1*int(10*w1#)3450  t#=t#+t8#:if t#>(t0#+t9#) then goto 62203470  rem "SEE IF DOCKED, THEN GET COMMAND"3480  goto 19803490  rem "EXCEEDED QUADRANT LIMITS"3500  x=8*q1+x+n*x1:y=8*q2+y+n*x2:q1=int(x/8):q2=int(y/8):s1=int(x-q1*8)3550  s2=int(y-q2*8):if s1=0 then q1=q1-1:s1=83590  if s2=0 then q2=q2-1:s2=83620  x5=0:if q1<1 then x5=1:q1=1:s1=13670  if q1>8 then x5=1:q1=8:s1=83710  if q2<1 then x5=1:q2=1:s2=13750  if q2>8 then x5=1:q2=8:s2=83790  if x5=0 then goto 38603800  print "LT. UHURA REPORTS MESSAGE FROM STARFLEET COMMAND:"3810  print "  'PERMISSION TO ATTEMPT CROSSING OF GALACTIC PERIMETER"3820  print "  IS HEREBY *DENIED*.  SHUT DOWN YOUR ENGINES.'"3830  print "CHIEF ENGINEER SCOTT REPORTS  'WARP ENGINES SHUT DOWN"3840  print "  AT SECTOR ";s1;",";s2;" OF QUADRANT ";q1;",";q2;".'"3850  if t>t0+t9 then goto 62203860  if (8*q1+q2)=(8*q4+q5) then goto 33703870  t#=t#+1:gosub 3910:goto 13203900  rem "MANEUVER ENERGY S/R **"3910  e=e-n-10:if e>=0 then return 3930  print "SHIELD CONTROL SUPPLIES ENERGY TO COMPLETE THE MANEUVER."3940  s=s+e:e=0:if s<=0 then s=03980  return 3990  rem "LONG RANGE SENSOR SCAN CODE"4000  if d#(3)<0 then print "LONG RANGE SENSORS ARE INOPERABLE":goto 19904030  print "LONG RANGE SCAN FOR QUADRANT: ";q1;",";q24040  o1$="-------------------":print o1$4060  for i=q1-1 to q1+1:n(1)=-1:n(2)=-2:n(3)=-3:for j=q2-1 to q2+14120  if (i>0)&(i<9)&(j>0)&(j<9) then n(j-q2+2)=g(i,j):z(i,j)=g(i,j)4180  next :for l=1 to 3:print ": ";:if n(l)<0 then print "*** ";:goto 42304210  print right$(str$(n(l)+1000),3);" ";4230  next :print ":":print o1$:next :goto 19904250  rem "PHASER CONTROL CODE BEGINS HERE"4260  if d#(4)<0 then print "PHASERS INOPERATIVE":goto 19904265  if (k3>0) then goto 43304270  print "SCIENCE OFFICER SPOCK REPORTS  'SENSORS SHOW NO ENEMY SHIPS"4280  print "                                IN THIS QUADRANT'":goto 19904330  if d#(8)<0 then print "COMPUTER FAILURE HAMPERS ACCURACY"4350  print "PHASERS LOCKED ON TARGET;  ";4360  print "ENERGY AVAILABLE =";e;" UNITS"4370  input "NUMBER OF UNITS TO FIRE: ";x#:if x#<=0 then goto 19904400  if e-x<0 then goto 43604410  e=e-x#:if d#(7)<0 then x#=x#*rnd(1)4450  h1=int(x#/k3):for i=1 to 3:if k(i,3)<=0 then goto 46704480  fnd():h=int((h1/value)*(rnd(1)+2)):if h>(0.15*k(i,3)) then goto 45304500  print "SENSORS SHOW NO DAMAGE TO ENEMY AT ";k(i,1);",";k(i,2):goto 46704530  k(i,3)=k(i,3)-h:print h;" UNIT HIT ON KLINGON AT SECTOR ";k(i,1);",";4550  print k(i,2):if k(i,3)<=0 then print "*** KLINGON DESTROYED ***":goto 45804560  print "   (SENSORS SHOW ";k(i,3);" UNITS REMAINING)":goto 46704580  k3=k3-1:k9=k9-1:z1=k(i,1):z2=k(i,2):a$="   ":gosub 86704650  k(i,3)=0:g(q1,q2)=g(q1,q2)-100:z(q1,q2)=g(q1,q2):if k9<=0 then goto 63704670  next :gosub 6000:goto 19904690  rem "PHOTON TORPEDO CODE BEGINS HERE"4700  if p<=0 then print "ALL PHOTON TORPEDOES EXPENDED":goto 19904730  if d#(5)<0 then print " PHOTON TUBES ARE NOT OPERATIONAL":goto 19904760  input "PHOTON TORPEDO COURSE (1-9): ";c1:if c1=9 then c1=14780  if (c1>=1)&(c1<9) then goto 48504790  print "ENSIGN CHEKOV REPORTS,  'INCORRECT COURSE DATA, SIR!'"4800  goto 19904850  x1=c(c1,1)+(c(c1+1,1)-c(c1,1))*(c1-int(c1)):e=e-2:p=p-14860  x2=c(c1,2)+(c(c1+1,2)-c(c1,2))*(c1-int(c1)):x=s1:y=s24910  print "TORPEDO TRACK:"4920  x=x+x1:y=y+x2:x3=int(x+0.5):y3=int(y+0.5)4960  if (x3<1)^(x3>8)^(y3<1)^(y3>8) then goto 54905000  print "               ";x3;",";y3:a$="   ":z1=x:z2=y:gosub 88305050  if z3<>0 then goto 49205060  a$="+K+":z1=x:z2=y:gosub 8830:if z3=0 then goto 52105110  print "** KLINGON DESTROYED **":k3=k3-1:k9=k9-1:if (k9<=0) then goto 63705150  for i=1 to 3:if (x3=k(i,1))&(y3=k(i,2)) then goto 51905180  next :i=35190  k(i,3)=0:goto 54305210  a$=" * ":z1=x:z2=y:gosub 8830:if z3=0 then goto 52805260  print "STAR AT";x3;",";y3;"ABSORBED TORPEDO ENERGY.":gosub 6000:goto 19905280  a$=">!<":z1=x:z2=y:gosub 8830:if z3=0 then goto 47605330  print "*** STARBASE DESTROYED ***":b3=b3-1:b9=b9-15360  if (b9>0)^(k9>t-t0-t9) then goto 54005370  print "THAT DOES IT, CAPTAIN!!  YOU ARE HEREBY RELIEVED OF COMMAND"5380  print "AND SENTENCED TO 360 STARDATES AT HARD LABOR ON CYGNUS 12!!"5390  goto 62705400  print "STARFLEET COMMAND REVIEWING YOUR RECORD TO CONSIDER"5410  print "COURT MARTIAL!":d0=05430  z1=x:z2=y:a$="   ":gosub 86705470  g(q1,q2)=k3*100+b3*10+s3:z(q1,q2)=g(q1,q2):gosub 6000:goto 19905490  print "TORPEDO MISSED!":gosub 6000:goto 19905520  rem "SHIELD CONTROL"5530  if d#(7)<0 then print "SHIELD CONTROL INOPERABLE":goto 19905560  print "ENERGY AVAILABLE =";e+s;:input "NUMBER OF UNITS TO SHIELDS: ";x5580  if (x<0)^(s=x) then print "<SHIELDS UNCHANGED>":goto 19905590  if x<=e+s then goto 56305600  print "SHIELD CONTROL REPORTS  'THIS IS NOT THE FEDERATION TREASURY.'"5610  print "<SHIELDS UNCHANGED>":goto 19905630  e=e+s-x:s=x:print "DEFLECTOR CONTROL ROOM REPORT:"5660  print "  'SHIELDS NOW AT ";int(s);" UNITS PER YOUR COMMAND.'":goto 19905680  rem "DAMAGE CONTROL"5690  if d#(6)>=0 then goto 59105700  print "DAMAGE CONTROL REPORT NOT AVAILABLE":if d0=0 then goto 19905720  #d3=0:for i=1 to 8:if #d(i)<0 then #d3=#d3+.15760  next :if d3=0 then goto 19905780  print :#d3=#d3+#d4:if #d3>=1 then #d3=0.95810  print "TECHNICIANS STANDING BY TO EFFECT REPAIRS TO YOUR SHIP;"5820  print "ESTIMATED TIME TO REPAIR:";0.01*int(100*d3);"STARDATES"5840  input "WILL YOU AUTHORIZE THE REPAIR ORDER (Y/N)";a$5860  if a$<>"Y"then 19905870  for i=1 to 8:if d(i)<0 then d(i)=05890  next :t#=t#+#d3+0.15910  print :print "DEVICE             STATE OF REPAIR":for r1=1 to 85920  gosub 8790:print g2$;left$(z$,25-len(g2$));int(d#(r1)*100)*0.015950  next :print :if d0#<>0 then goto 57205980  goto 19905990  rem "KLINGONS SHOOTING"6000  if k3<=0 then return 6010  if d0#<>0 then print "STARBASE SHIELDS PROTECT THE ENTERPRISE":return 6040  for i=1 to 3:if k(i,3)<=0 then goto 62006060  fnd():h=int((k(i,3)/value)*(2+rnd(1))):s=s-h6070  k(i,3)=int(k(i,3)/3+rnd(0))6080  print h;"UNIT HIT ON ENTERPRISE FROM SECTOR ";k(i,1);",";k(i,2)6090  if s<=0 then goto 62406100  print "      <SHIELDS DOWN TO ";s;" UNITS>":if h<20 then goto 62006120  if (rnd(1)>0.6)^(h/s<=0.02) then goto 62006140  r1=random(8)+1:d#(r1)=d#(r1)-h/s-0.5*rnd(1):gosub 87906170  print "DAMAGE CONTROL REPORTS ";g2$;" DAMAGED BY THE HIT'"6200  next :return 6210  rem "END OF GAME"6220  print "IT IS STARDATE";t:goto 62706240  print :print "THE ENTERPRISE HAS BEEN DESTROYED.  THE FEDERATION ";6250  print "WILL BE CONQUERED":goto 62206270  print "THERE WERE ";k9;" KLINGON BATTLE CRUISERS LEFT AT"6280  print "THE END OF YOUR MISSION."6290  print :print :if b9=0 then goto 63606310  print "THE FEDERATION IS IN NEED OF A NEW STARSHIP COMMANDER"6320  print "FOR A SIMILAR MISSION -- IF THERE IS A VOLUNTEER,"6330  input "LET HIM STEP FORWARD AND ENTER 'AYE'";a$:if a$="AYE"then goto 2186360  end 6370  print "CONGRULATION, CAPTAIN!  THEN LAST KLINGON BATTLE CRUISER"6380  print "MENACING THE FEDERATION HAS BEEN DESTROYED.":print 6400  pow2(k7/(t-t0)):print "YOUR EFFICIENCY RATING IS: ";1000*value:goto 62906420  rem "SHORT RANGE SENSOR SCAN & STARTUP SUBROUTINE"6430  for i=s1-1 to s1+16435  for j=s2-1 to s2+16450  if (int(i+0.5)<1)^(int(i+0.5)>8)^(int(j+0.5)<1)^(int(j+0.5)>8)6460  goto 65406470  endif 6490  a$=">!<":z1=i:z2=j:gosub 8830:if z3=1 then goto 65806540  next :next :d0=0:goto 66506580  d0=1:c$="DOCKED":e=e0:p=p06620  print "SHIELDS DROPPED FOR DOCKING PURPOSES":s=0:goto 67206650  if k3>0 then c$="*RED*":goto 67206660  c$="GREEN":if e<e0*0.1 then c$="YELLOW"6720  if d#(2)>=0 then goto 67706730  print :print "*** SHORT RANGE SENSORS ARE OUT ***":print :return 6770  o1$="---------------------------------":print o1$6775  for i=1 to 86820  for j=0 to 7:print "|";mid$(q$,((i-1)*24+j*3)+1,3);:next 6825  print "|":print o1$6830  next 6835  print 6840  for c=1 to 86850  if c=1 then print "STARDATE           ";int((t#*10)*0.1)6900  if c=2 then print "CONDITION          ";c$6960  if c=3 then print "QUADRANT           ";q1;",";q27020  if c=4 then print "SECTOR             ";s1;",";s27070  if c=5 then print "PHOTON TORPEDOES   ";int(p)7120  if c=6 then print "TOTAL ENERGY       ";int(e+s)7180  if c=7 then print "SHIELDS            ";int(s)7240  if c=8 then print "KLINGONS REMAINING ";int(k9)7260  next :print o1$:return 7280  rem "LIBRARY COMPUTER CODE"7290  if d#(8)<0 then print "COMPUTER DISABLED":goto 19907300  h8=17310  print "FUNCTIONS AVAILABLE FROM LIBRARY-COMPUTER:"7315  print "   1 = CUMULATIVE GALACTIC RECORD"7320  print "   2 = STATUS REPORT"7325  print "   3 = PHOTON TORPEDO DATA"7330  print "   4 = STARBASE NAV DATA"7335  print "   5 = DIRECTION/DISTANCE CALCULATOR"7340  print "   6 = GALAXY 'REGION NAME' MAP"7350  print :print "COMPUTER ACTIVE, PRESS COMMAND KEY:"7360  k=0:while k=0:k=inkey():wend 7365  if k=48+1 then goto 75407370  if k=48+2 then goto 79007375  if k=48+3 then goto 80707380  if k=48+4 then goto 85007385  if k=48+5 then goto 81507390  if k=48+6 then goto 74007395  goto 19907397  rem "SETUP TO CHANGE CUM GAL RECORD TO GALAXY MAP"7400  h8=0:g5=1:print "                        THE GALAXY":goto 75507530  rem "CUM GALACTIC RECORD"7540  print :print "        ";7544  print "COMPUTER RECORD OF GALAXY FOR QUADRANT";q1;",";q27546  print 7550  print "       1     2     3     4     5     6     7     8"7560  o1$="     ----- ----- ----- ----- ----- ----- ----- -----"7570  print o1$:for i=1 to 8:print i;:if h8=0 then goto 77407630  for j=1 to 8:print "   ";:if z(i,j)=0 then print "***";:goto 77207700  print right$(str$(z(i,j)+1000),3);7720  next :goto 78507740  z4=i:z5=1:gosub 9030:j0=int(15-0.5*len(g2$)):print spc(j0);g2$;7750  j1=j0+len(g2$)7800  z5=5:gosub 9030:j0=int((39-j1)-0.5*len(g2$)):print spc(j0);g2$;7850  print :print o1$:next :print :goto 19907890  rem "STATUS REPORT"7900  print "   STATUS REPORT:":x$="":if k9>1 then x$="S"7940  print "KLINGON";x$;" LEFT: ";k97960  print "MISSION MUST BE COMPLETED IN ";0.1*int((t0#+t9#-t#)*10);7965  print " STARDATES"7970  x$="S":if b9<2 then x$="":if b9<1 then 80107980  print "THE FEDERATION IS MAINTAINING ";b9;" STARBASE";x$;" IN THE GALAXY"7990  goto 56908010  print "YOUR STUPIDITY HAS LEFT YOU ON YOUR OWN IN"8020  print "  THE GALAXY -- YOU HAVE NO STARBASES LEFT!":goto 56908060  rem "TORPEDO, BASE NAV, D/D CALCULATOR"8070  if k3<=0 then goto 42708080  x$="":if k3>1 then x$="S"8090  print "FROM ENTERPRISE TO KLINGON BATTLE CRUSER";x$8100  h8=0:for i=1 to 3:if k(i,3)<=0 then goto 84808110  w1=k(i,1):x=k(i,2)8120  c1=s1:a=s2:goto 82208150  print "DIRECTION/DISTANCE CALCULATOR:"8160  print "YOU ARE AT QUADRANT ";q1;",";q2;" SECTOR ";s1;",";s28170  print "PLEASE ENTER":input "  INITIAL COORDINATES (X,Y)";c1,a8200  input "  FINAL COORDINATES (X,Y)";w1,x8220  x=x-a:a=c1-w1:if x<0 then goto 83508250  if a<0 then goto 84108260  if x>0 then goto 82808270  if a=0 then c1=5:goto 82908280  c1=18290  if abs(a)<=abs(x) then goto 83308310  print "DIRECTION =";c1+(((abs(a)-abs(x))+abs(a))/abs(a)):goto 84608330  print "DIRECTION =";c1+(abs(a)/abs(x)):goto 84608350  if a>0 then c1=3:goto 84208360  if x<>0 then c1=5:goto 82908410  c1=78420  if abs(a)>=abs(x) then 84508430  print "DIRECTION =";c1+(((abs(x)-abs(a))+abs(x))/abs(x)):goto 84608450  print "DIRECTION =";c1+(abs(x)/abs(a))8455  pow2(x):value1=value:pow2(a):value=value+value18460  sqr(value):print "DISTANCE =";value:if h8=1 then goto 19908480  next :goto 19908500  if b3<>0 then print "FROM ENTERPRISE TO STARBASE:":w1=b4:x=b5:goto 81208510  print "MR. SPOCK REPORTS,  'SENSORS SHOW NO STARBASES IN THIS";8520  print " QUADRANT.'":goto 19908580  rem "FIND EMPTY PLACE IN QUADRANT (FOR THINGS)"8590  r1=random(8)+1:r2=random(8)+1:a$="   ":z1=r1:z2=r2:gosub 88308595  if z3=0 then goto 85908600  return 8660  rem "INSERT IN STRING ARRAY FOR QUADRANT"8670  s8=int(z2-0.5)*3+int(z1-0.5)*24+18675  if len(a$)<>3 then print "ERROR":stop 8680  if s8=1 then q$=a$+right$(q$,189):return 8690  if s8=190 then q$=left$(q$,189)+a$:return 8700  q$=left$(q$,s8-1)+a$+right$(q$,190-s8):return 8780  rem "PRINTS DEVICE NAME"8790  if r1=1 then g2$="WARP ENGINES"8794  if r1=2 then g2$="SHORT RANGE SENSORS"8796  if r1=3 then g2$="LONG RANGE SENSORS"8798  if r1=4 then g2$="PHASER CONTROL"8800  if r1=5 then g2$="PHOTON TUBES"8802  if r1=6 then g2$="DAMAGE CONTROL"8804  if r1=7 then g2$="SHIELD CONTROL"8806  if r1=8 then g2$="LIBRARY-COMPUTER"8810  return 8820  rem "STRING COMPARISON IN QUADRANT ARRAY"8830  z1=int(z1+1):z2=int(z2+1):s8=(z2-1)*3+(z1-1)*24+1:z3=08890  if mid$(q$,s8,3)=a$ then z3=18900  return 9010  rem "QUADRANT NAME IN G2$ FROM Z4,Z5 (=Q1,Q2)"9020  rem "CALL WITH G5=1 TO GET REGION NAME ONLY"9030  if z5<=49040  if z4=1 then g2$="ANTARES"9050  if z4=2 then g2$="RIGEL"9060  if z4=3 then g2$="PROCYON"9070  if z4=4 then g2$="VEGA"9080  if z4=5 then g2$="CANOPUS"9090  if z4=6 then g2$="ALTAIR"9100  if z4=7 then g2$="SAGITTARIUS"9110  if z4=8 then g2$="POLLUX"9120  else 9130  if z4=1 then g2$="SIRIUS"9140  if z4=2 then g2$="DENEB"9150  if z4=3 then g2$="CAPELLA":9160  if z4=4 then g2$="BETELGEUSE"9170  if z4=5 then g2$="ALDEBARAN"9180  if z4=6 then g2$="REGULUS"9190  if z4=7 then g2$="ARCTURUS"9200  if z4=18 then g2$="SPICA"9205  endif 9210  if g5<>19230  if (z5=1)^(z5=5) then g2$=g2$+" I":return 9240  if (z5=2)^(z5=6) then g2$=g2$+" II":return 9250  if (z5=3)^(z5=7) then g2$=g2$+" III":return 9260  if (z5=4)^(z5=8) then g2$=g2$+" IV":return 9270  endif 9280  return 9290  end 10000 rem "FUNCTION D, RETURNS VALUE"10005 proc fnd()10010 pow2(k(i,1)-s1):value1=value10020 pow2(k(i,2)-s2):value=value+value1:sqr(value)10030 endproc 10040 rem "FUNCTION R, RETURNS RANDOM VALUE (1-8)"10050 proc fnr(d)10060 value=int(rnd(r)*7.98+1.01)10070 endproc 10090 rem "FUNCTION SQR -NEWTON'S METHOD OF CALCULATING SQRT, RETURNS GUESS#"10100 proc sqr(n)10110 n#=n:guess#=n#10120 while (0.001<abs(guess#*guess#-n#))10130 guess#=(guess#+n/guess#)/210140 wend 10150 endproc 10200 proc pow2(n)10210 value=n*n10220 endproc 